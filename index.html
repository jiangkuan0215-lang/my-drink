<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>è±ªè¯ç‰ˆå£“åŠ›æ’è§£è£ç½®</title>
    <style>
        :root {
            --primary-color: #E87A90;
            --secondary-color: #D0104C;
            --bg-color: #fff5f5;
        }
        body { 
            font-family: 'Microsoft JhengHei', sans-serif; 
            background-color: var(--bg-color); 
            display: flex; flex-direction: column; align-items: center;
            padding: 40px 20px; margin: 0;
        }
        .card { 
            background: #7B90D2; border-radius: 20px; padding: 30px; 
            box-shadow: 0 15px 30px rgba(0,0,0,0.15); 
            width: 100%; max-width: 400px; 
            border: 5px solid var(--secondary-color); text-align: center;
            margin-bottom: 20px; position: relative;
        }
        /* éœéŸ³æŒ‰éˆ•æ¨£å¼ */
        .mute-btn {
            position: absolute; top: 15px; right: 15px;
            background: rgba(255,255,255,0.3); border: none;
            border-radius: 50%; width: 40px; height: 40px;
            cursor: pointer; font-size: 1.2rem; display: flex;
            align-items: center; justify-content: center; transition: 0.3s;
        }
        .mute-btn:hover { background: rgba(255,255,255,0.5); }

        h2 { color: white; margin-top: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        .result-box { 
            margin: 20px 0; padding: 20px; 
            background: #FCFAF2; border-radius: 15px; 
            min-height: 100px; border: 2px solid #eee;
        }
        .shop-name { font-size: 1.1rem; color: #666; margin-bottom: 8px; }
        .drink-name { 
            font-size: 2rem; font-weight: bold; color: #86C166; 
            min-height: 2.5rem; display: flex; align-items: center; justify-content: center;
        }
        button#btn { 
            background: var(--primary-color); color: white; border: none; 
            padding: 15px 40px; font-size: 1.2rem; border-radius: 50px; 
            cursor: pointer; transition: 0.3s; width: 100%;
            box-shadow: 0 5px 15px rgba(232, 122, 144, 0.4);
        }
        button#btn:hover { background: #d63031; transform: translateY(-2px); }
        button#btn:disabled { background: #ccc; cursor: not-allowed; }

        .history-area {
            width: 100%; max-width: 400px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px; padding: 15px;
            margin-bottom: 20px; box-sizing: border-box; display: none;
        }
        .history-title { font-weight: bold; color: #555; font-size: 0.9rem; border-bottom: 1px solid #E87A90; padding-bottom: 5px; margin-bottom: 10px; }
        .history-item { font-size: 0.85rem; color: #444; padding: 6px 0; border-bottom: 1px dashed #ddd; display: flex; justify-content: space-between; }
        .history-time { color: #999; font-size: 0.75rem; }

        .config-area {
            width: 100%; max-width: 400px;
            background: white; padding: 20px; border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); text-align: left;
        }
        textarea {
            width: 100%; height: 120px; border: 1px solid #ddd;
            border-radius: 8px; padding: 10px; font-size: 0.9rem;
            resize: vertical; box-sizing: border-box; font-family: inherit;
        }
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); color: #D0104C; }
        }
        .animate-win { animation: bounce 0.5s ease; }
    </style>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<audio id="winSound" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3" preload="auto"></audio>

<div class="card">
    <button class="mute-btn" id="muteBtn" onclick="toggleMute()">ğŸ”Š</button>
    
    <h2>ğŸ¥¤ å·¥ä½œå£“åŠ›æ¸›ç·©è£ç½®</h2>
    <div class="result-box">
        <div id="shopDisplay" class="shop-name">æº–å‚™å¥½å–äº›ä»€éº¼äº†å—ï¼Ÿ</div>
        <div id="drinkDisplay" class="drink-name">---</div>
    </div>
    <button id="btn" onclick="startSpin()">LINK STARï¼</button>
</div>

<div class="history-area" id="historyArea">
    <div class="history-title">ğŸ“œ æœ€è¿‘å®‰æ’ç´€éŒ„</div>
    <div id="historyList"></div>
</div>

<div class="config-area">
    <h3>âš™ï¸ å®¢è£½åŒ–æ‚¨çš„é¤é»</h3>
    <textarea id="menuInput">
50åµ:å°çç å¥¶èŒ¶,æ³¢éœ¸ç´…,å››å­£æ˜¥,8å†°ç¶ ,å†°æ·‡æ·‹ç´…èŒ¶,éºµèŒ¶ç´…èŒ¶,é˜¿è¯ç”°,æ¤°æœå¥¶ç¶ 
è¿·å®¢å¤:å¤§ç”²èŠ‹é ­é®®å¥¶,æ±ºæ˜å¤§éº¥,çç ç´…èŒ¶æ‹¿éµ,é’æª¸é¦™èŒ¶,éœå²¡ç„™ç„™é®®å¥¶,å¨œæ¯ç´…èŒ¶æ‹¿éµ,æ³•èŠ™å¨œå¯å¯é®®å¥¶
å¯ä¸å¯:ç†Ÿæˆç´…èŒ¶,èƒ­è„‚ç´…èŒ¶,æ˜¥èŠ½ç¶ èŒ¶,ç™½ç‰æ­è•¾,é’æª¸ç¶ èŒ¶,è¼•çº–æ¦–å¥ˆèŒ¶,èƒ­è„‚å¤šå¤š
éº»å¤èŒ¶åŠ:æ¥Šæç”˜éœ²,èŠèŠè“è“,é«˜å±±é‡‘è±,æŸ³æ©™æœç²’èŒ¶
é¾œè¨˜:ä¸‰åä¸‰èŒ¶ç‹,ç´…æŸšç¿¡ç¿ ,è˜‹æœç´…å®£,èœœæ¡ƒçƒé¾,é˜¿æºæ¥Šæ¡ƒç´…èŒ¶,é¾œè¨˜æ¿ƒä¹³èŒ¶,æ¥µå“æ¿ƒä¹³èŒ¶,é›·å¤¢è˜†è–ˆèœœ</textarea>
</div>

<script>
    let isSpinning = false;
    let isMuted = false;
    let historyRecords = [];

    function toggleMute() {
        isMuted = !isMuted;
        const btn = document.getElementById('muteBtn');
        btn.innerText = isMuted ? "ğŸ”‡" : "ğŸ”Š";
    }

    function getMenuFromInput() {
        const text = document.getElementById('menuInput').value.trim();
        const lines = text.split('\n');
        const customMenu = {};
        lines.forEach(line => {
            const parts = line.split(':');
            if (parts.length === 2) {
                const shop = parts[0].trim();
                const drinks = parts[1].split(',').map(d => d.trim()).filter(d => d !== "");
                if (shop && drinks.length > 0) customMenu[shop] = drinks;
            }
        });
        return customMenu;
    }

    function startSpin() {
        if (isSpinning) return;
        const menu = getMenuFromInput();
        const shops = Object.keys(menu);
        if (shops.length === 0) { alert("çµ¦æˆ‘æ‰“æ­£ç¢ºçš„æ ¼å¼é˜¿äººé¡ï¼"); return; }

        isSpinning = true;
        document.getElementById('btn').disabled = true;
        document.getElementById('drinkDisplay').classList.remove('animate-win');

        let count = 0;
        const totalSpins = 25; 
        const timer = setInterval(() => {
            const tempShop = shops[Math.floor(Math.random() * shops.length)];
            const tempDrink = menu[tempShop][Math.floor(Math.random() * menu[tempShop].length)];
            document.getElementById('shopDisplay').innerText = "ğŸ” ç‚ºæ‚¨å®‰æ’ä¸­ï¼š" + tempShop;
            document.getElementById('drinkDisplay').innerText = tempDrink;
            count++;
            if (count >= totalSpins) {
                clearInterval(timer);
                finishSpin(menu);
            }
        }, 60);
    }

    function finishSpin(menu) {
        const shops = Object.keys(menu);
        const finalShop = shops[Math.floor(Math.random() * shops.length)];
        const finalDrink = menu[finalShop][Math.floor(Math.random() * menu[finalShop].length)];

        document.getElementById('shopDisplay').innerText = "ğŸ“ å°±æ±ºå®šæ˜¯ä½ äº†ï¼å‡ºä¾†å§ï¼š" + finalShop;
        document.getElementById('drinkDisplay').innerText = finalDrink;
        document.getElementById('drinkDisplay').classList.add('animate-win');

        // å½©å¸¶
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });

        // åˆ¤æ–·æ˜¯å¦æ’­æ”¾éŸ³æ¨‚
        if (!isMuted) {
            const audio = document.getElementById('winSound');
            audio.currentTime = 0;
            audio.play().catch(() => {});
        }

        updateHistory(finalShop, finalDrink);
        document.getElementById('btn').disabled = false;
        isSpinning = false;
    }

    function updateHistory(shop, drink) {
        const now = new Date();
        const time = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
        historyRecords.unshift({ shop, drink, time });
        if (historyRecords.length > 5) historyRecords.pop();
        const historyArea = document.getElementById('historyArea');
        const historyList = document.getElementById('historyList');
        historyArea.style.display = 'block';
        historyList.innerHTML = historyRecords.map(item => `
            <div class="history-item">
                <span><strong>${item.shop}</strong> - ${item.drink}</span>
                <span class="history-time">${item.time}</span>
            </div>
        `).join('');
    }
</script>

</body>
</html>
